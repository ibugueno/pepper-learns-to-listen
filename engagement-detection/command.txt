#prepare


root@67aaa64b6a3e:/app/engagement-detection# python 0_prepare_dipser_engagement.py \
    --dipser-root /app/input/dipser/DIPSER/V5/DIPSER \
    --out-root    /app/input/dipser/engagement_single_v1 \
    --labeler-json labeler_01.json \
    --min-frames-per-subject 8 \
    --val-ratio 0.2

# faces

root@67aaa64b6a3e:/app/engagement-detection# python 1_precompute_dipser_bboxes.py \
  --train-csv /app/input/dipser/engagement_single_v1/train.csv \
  --val-csv   /app/input/dipser/engagement_single_v1/val.csv \
  --out-dir   /app/input/dipser/engagement_single_v1_bbox


#train

root@67aaa64b6a3e:/app/engagement-detection# python 2_train_engagement_dipser.py \
  --train-csv /app/input/dipser/engagement_single_v1_bbox/train_bbox.csv \
  --val-csv   /app/input/dipser/engagement_single_v1_bbox/val_bbox.csv \
  --gpu 0 \
  --backbone vit_b16 \
  --img-size 224 \
  --batch-size 32 \
  --epochs 30 \
  --n-classes 2 \
  --out-dir /app/output/dipser_single_vit_faces_bin

  # eval

(env) root@67aaa64b6a3e:/app/engagement-detection# python 3_eval_engagement_dipser.py \
  --val-csv /app/input/dipser/engagement_single_v1_bbox/val_bbox.csv \
  --checkpoint /app/output/dipser_single_vit_faces_bin/best.pt \
  --save /app/output/eval_dipser_single_vit_faces_bin/engagement_examples.png \
  --gpu 0
