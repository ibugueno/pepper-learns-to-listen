# for inspect

python 0_inspect_biwi_dataset.py \
    --faces_dir /media/ignacio/KINGSTON/biwi-kinect-head/archive/faces_0 \
    --db_annotations /media/ignacio/KINGSTON/biwi-kinect-head/archive/db_annotations \
    --subject 01 \
    --frame 00003

# for csv

python 1_build_biwi_crops_and_csv.py \
  --faces-dir /media/ignacio/KINGSTON/biwi-kinect-head/archive/faces_0 \
  --masks-dir /media/ignacio/KINGSTON/biwi-kinect-head/archive/head_pose_masks \
  --out-root  /media/ignacio/KINGSTON/biwi-kinect-head/crops_yolo \
  --train-csv /media/ignacio/KINGSTON/biwi-kinect-head/crops_yolo/train_yolo.csv \
  --val-csv   /media/ignacio/KINGSTON/biwi-kinect-head/crops_yolo/val_yolo.csv \
  --val-split 0.2 \
  --pad 15 \
  --abs-paths \e
  --yolo-model yolov8n-face.pt \
  --yolo-conf 0.4 \
  --yolo-img-size 640


# for training

python 2_train_biwi_vit.py \
  --train-manifest /app/input/biwi-kinect-head/crops_yolo/train_yolo.csv \
  --val-manifest   /app/input/biwi-kinect-head/crops_yolo/val_yolo.csv \
  --data-root      /app/input/biwi-kinect-head \
  --gpu 0 \
  --img-size 224 \
  --batch-size 64 \
  --num-workers 8 \
  --augment \
  --model vit_base_patch16_224 \
  --pretrained \
  --epochs 50 \
  --out-dir /app/output/biwi-kinect-head/runs_vit_rgbd

  # for evaluate

python 3_eval_biwi_vit_rgbd.py \
  --val-manifest /app/input/biwi-kinect-head/crops_yolo/val_yolo.csv \
  --data-root /app/input/biwi-kinect-head \
  --checkpoint /app/output/biwi-kinect-head/runs_vit_rgbd/best.pt \
  --output-dir /app/output/biwi-kinect-head/eval_vit_rgbd_val_pdfs \
  --batch-size 64 \
  --num-workers 8



